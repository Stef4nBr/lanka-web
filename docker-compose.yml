version: '3.8'

services:
  lanka-web:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - REACT_APP_API_URL=${REACT_APP_API_URL:-http://localhost:4000}
    container_name: lanka-web
    ports:
      - "3000:3000"  # Frontend
      - "4000:4000"  # Backend API
    environment:
      - PORT=${PORT:-4000}
      # Database Configuration
      - ADMIN_USERNAME=${ADMIN_USERNAME:-admin}
      - ADMIN_EMAIL=${ADMIN_EMAIL:-admin@example.com}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-password}
      # JWT Configuration
      - JWT_SECRET=${JWT_SECRET:-your_secret_key_here}
    volumes:
      # Persist database
      - ./backend/data.db:/app/backend/data.db
      # Optional: Mount files directory for uploads
      - ./frontend/public/files:/app/frontend/build/files
    restart: unless-stopped
    networks:
      - lanka-network

networks:
  lanka-network:
    driver: bridge
